<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content=
		"width=device-width, initial-scale=1.0">
	<title>Dice Game</title>

<style>
	.container {
		width: 70%;
		margin: auto;
		text-align: center;
	}

	.dice {
		text-align: center;
		display: inline-block;
		margin: 10px;
	}

	body {
		background-color: #042f4b;
		margin: 0;
	}

	h1 {
		margin: 10px;
		font-family: "Lobster", cursive;
		text-shadow: 5px 0 #232931;
		font-size: 3.5rem;
		color: #4ecca3;
		text-align: center;
	}

	p {
		font-size: 2rem;
		color: #4ecca3;
		font-family: "Indie Flower", cursive;
	}

	img {
		width: 100%;
	}

	.bottom {
		padding-top: 30px;
	}

	.butn {
		background: #4ecca3;
		font-family: "Indie Flower", cursive;
		border-radius: 7px;
		color: #ffff;
		font-size: 20px;
		padding: 6px 25px 6px 25px;
		text-decoration: none;
	}

	.butn:hover {
		background: #232931;
		text-decoration: none;
	}
</style>

</head>

<body>

 <div class="container">
		<h1>Let's Play</h1>

		<div class="dice">
		  <p class="Player1">Bob</p>
		  <p class="Points1">0</p>
		  <p class="Die1">1</p>
		  <img class="img1" src="dice1.png">
		</div>

		<div class="dice">
		  <p class="Player2">Ron</p>
		  <p class="Points2">0</p>
		  <p class="Die2">1</p>
	          <img class="img2" src="dice2.png">
		</div>
		<div class="dice">
		  <p class="Die3">1</p>
	          <img class="img3" src="dice3.png">
		</div>
	</div>

	<div class="container bottom">
		  <button type="button" class="butn"
			onClick="lambdaNewGame()">
			New Game 
                  </button>
	</div>

	<div class="container bottom">
		  <button type="button" class="butn"
			onClick="rollTheDice('p1Turn')">
			Player1 Roll
                  </button>
	</div>
	<div class="container bottom">
		  <button type="button" class="butn"
			onClick="rollTheDice('p2Turn')">
			Player2 Roll
                  </button>
	</div>
	<div class="container bottom">
		<button type="button" class="butn"
			onClick="editNames()">
			Edit Names
		</button>
        </div>

 
<script>

	// Player name
  var player1 = "Player 1";
  var player2 = "Player 2";
  var wins1 = 0;
  var wins2 = 0;
  var mybody;
  var pmybody;
  var turn;


  function lambdaCall(lambdaBody) {
		            // instantiate a headers object
		            var myHeaders = new Headers();
		            // add content type header to object
		            myHeaders.append("Content-Type", "application/json");
		            var requestOptions = {
				                    method: 'POST',
				                    headers: myHeaders,
				                    body: lambdaBody,
				                    redirect: 'follow'
				                };
		            // make API call with parameters and use promises to get response
		            fetch("https://gfkcm1eej6.execute-api.us-west-2.amazonaws.com/dev", requestOptions)
		            .then(response => response.text())
		            //.then(result => alert(JSON.parse(result).body))
		            .then(result => mybody = JSON.parse(result).body)
		            .catch(error => console.log('error', error));
	  return mybody;
  }


  function lambdaNewGame(){
    // create a JSON object with parameters for API call and store in a variable
    var lambdaBody = JSON.stringify({"action":"newGame"});
    var lResult;
    var plResult;
    lResult = lambdaCall(lambdaBody);
    document.getElementById("Lambda_result").innerHTML = lResult;
    console.log(lResult);
    var gameId = lResult.game_id;
    console.log("Game Id is:  " + gameId);
  }


// Function to change the player name
  function editNames() {
    player1 = prompt("Change Player1 name");
    player2 = prompt("Change player2 name");
    var lambdaBody = JSON.stringify({"action":"edit_names","player1Name":player1,"player2Name":player2});
    var lResult = lambdaCall(lambdaBody);
    console.log(lResult);

    document.getElementById("Lambda_result").innerHTML = lResult;

    document.querySelector("p.Player1").innerHTML = player1;
    document.querySelector("p.Player2").innerHTML = player2;
  }

  // Function to roll the dice
  function rollTheDice(turn) {
    setTimeout(function () {
      //var randomNumber1 = Math.floor(Math.random() * 6) + 1;
      //var randomNumber2 = Math.floor(Math.random() * 6) + 1;

      var lambdaBody = JSON.stringify({"action":"roll"});
      var lResult;
      var plResult;
      plResult = lambdaCall(lambdaBody);
      document.getElementById("Lambda_result").innerHTML = lResult;
      console.log(plResult);
      console.log("first die " + plResult.die1);
      console.log("second die " + plResult.die2);
      var randomNumber1 = plResult.die1;
      var randomNumber2 = plResult.die2;
      var randomNumber3 = plResult.die3;
      
       document.querySelector("p.Die1").innerHTML = randomNumber1;
       document.querySelector("p.Die2").innerHTML = randomNumber2;
       document.querySelector("p.Die3").innerHTML = randomNumber3;
      document.querySelector(".img1").setAttribute("src",
				  "dice" + randomNumber1 + ".png");
  
      document.querySelector(".img2").setAttribute("src",
				  "dice" + randomNumber2 + ".png");
  
      document.querySelector(".img3").setAttribute("src",
				  "dice" + randomNumber3 + ".png");
  
      if (randomNumber1 === randomNumber2) {
	      document.querySelector("h1").innerHTML = "Draw!";
      }
  
     else if (randomNumber1 < randomNumber2) {
      wins2 += 1;
      document.querySelector("h1").innerHTML 	= (player2 + " WINS!");
      document.querySelector("p.Points2").innerHTML 	= wins2;
      }
  
     else {
      wins1 += 1;
      document.querySelector("h1").innerHTML = (player1 + " WINS!");
      document.querySelector("p.Points1").innerHTML 	= wins1;
      }
    }, 2500);
  }
</script>

<p id="Lambda_result"</p>

</body>
	
</html>
